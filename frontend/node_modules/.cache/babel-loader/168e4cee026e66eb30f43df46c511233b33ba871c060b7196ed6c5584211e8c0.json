{"ast":null,"code":"import React,{createContext,useEffect,useState}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";export const ShopContext=/*#__PURE__*/createContext(null);const getDefaultCart=()=>{let cart={};for(let index=0;index<300+1;index++){cart[index]=0;}return cart;};const ShopContextProvider=props=>{const[all_product,setAll_Product]=useState([]);const[cartItems,setCartItems]=useState(getDefaultCart());useEffect(()=>{fetch('http://localhost:4000/allproducts').then(response=>response.json()).then(data=>setAll_Product(data));if(localStorage.getItem('auth-token')){fetch('http://localhost:4000/getcart',{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:\"\"}).then(response=>{console.log(response);return response.json();}).then(data=>setCartItems(data));}},[]);const addToCart=itemId=>{setCartItems(prev=>({...prev,[itemId]:prev[itemId]+1}));console.log(itemId);if(localStorage.getItem('auth-token')){fetch('http://localhost:4000/addtocart',{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:JSON.stringify({\"itemID\":itemId})}).then(response=>{return response.json();}).then(data=>console.log(data));}};const removeFromCart=itemId=>{setCartItems(prev=>({...prev,[itemId]:prev[itemId]-1}));if(localStorage.getItem('auth-token')){fetch('http://localhost:4000/removefromcart',{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:JSON.stringify({\"itemID\":itemId})}).then(response=>response.json()).then(data=>console.log(data));}};const getTotalCartAmount=()=>{let totalAmount=0;for(const item in cartItems){if(cartItems[item]>0){let itemInfo=all_product.find(product=>product.id===Number(item));totalAmount+=itemInfo.new_price*cartItems[item];}}return totalAmount;};const getTotalCartItems=()=>{let totalItem=0;for(const item in cartItems){if(cartItems[item]>0){totalItem+=cartItems[item];}}return totalItem;};const contextValue={getTotalCartItems,getTotalCartAmount,all_product,cartItems,addToCart,removeFromCart};return/*#__PURE__*/_jsx(ShopContext.Provider,{value:contextValue,children:props.children});};export default ShopContextProvider;","map":{"version":3,"names":["React","createContext","useEffect","useState","jsx","_jsx","ShopContext","getDefaultCart","cart","index","ShopContextProvider","props","all_product","setAll_Product","cartItems","setCartItems","fetch","then","response","json","data","localStorage","getItem","method","headers","Accept","concat","body","console","log","addToCart","itemId","prev","JSON","stringify","removeFromCart","getTotalCartAmount","totalAmount","item","itemInfo","find","product","id","Number","new_price","getTotalCartItems","totalItem","contextValue","Provider","value","children"],"sources":["C:/Users/onkar/OneDrive/Documents/VS Code projects/UPGRAD ECOMMERCE/mern_ecommerce/frontend/src/Context/ShopContext.jsx"],"sourcesContent":["import React, { createContext, useEffect, useState } from \"react\";\n\nexport const ShopContext = createContext(null);\n\nconst getDefaultCart=()=>{\n    let cart={}\n    for (let index = 0; index < 300+1; index++) {\n        cart[index] = 0;\n    }\n    return cart;\n}\n\nconst ShopContextProvider = (props)=>{\n\n    const [all_product, setAll_Product]=useState([]);\n    const [cartItems, setCartItems] = useState(getDefaultCart());\n\n    useEffect(()=>{\n        fetch('http://localhost:4000/allproducts')\n        .then((response)=>response.json())\n        .then((data)=>setAll_Product(data))\n\n        if(localStorage.getItem('auth-token')){\n            fetch('http://localhost:4000/getcart', {\n                method: 'POST',\n                headers:{\n                    Accept:'application/form-data',\n                    'auth-token':`${localStorage.getItem('auth-token')}`,\n                    'Content-Type':'application/json'\n                },\n                body:\"\",\n            }).then((response)=>{\n                console.log(response)\n                return response.json()})\n            .then((data)=>setCartItems(data))\n        }\n    },[])\n    \n    const addToCart =(itemId)=>{\n        setCartItems((prev)=>({...prev, [itemId]:prev[itemId]+1}))\n        console.log(itemId)\n\n        if(localStorage.getItem('auth-token')){\n            fetch('http://localhost:4000/addtocart',{\n                method:'POST',\n                headers:{\n                    Accept:'application/form-data',\n                    'auth-token':`${localStorage.getItem('auth-token')}`,\n                    'Content-Type':'application/json'\n                },\n                body:JSON.stringify({\"itemID\":itemId}),\n            })\n            .then((response)=> {\n                return response.json()\n            })\n            .then((data)=>console.log(data))\n        }\n    }\n    const removeFromCart =(itemId)=>{\n        setCartItems((prev)=>({...prev, [itemId]:prev[itemId]-1}))\n        if(localStorage.getItem('auth-token')){\n            fetch('http://localhost:4000/removefromcart',{\n                method:'POST',\n                headers:{\n                    Accept:'application/form-data',\n                    'auth-token':`${localStorage.getItem('auth-token')}`,\n                    'Content-Type':'application/json'\n                },\n                body:JSON.stringify({\"itemID\":itemId}),\n            })\n            .then((response)=> response.json())\n            .then((data)=>console.log(data))\n        }\n    }\n\n    const getTotalCartAmount = () => {\n        let totalAmount = 0;\n        for(const  item in cartItems){\n            if(cartItems[item]>0){\n                let itemInfo = all_product.find((product) => product.id === Number(item));\n                totalAmount += itemInfo.new_price * cartItems[item];\n            }\n        }\n        return totalAmount;\n\n    }\n\n    const getTotalCartItems =()=>{\n        let totalItem =0;\n        for(const item in cartItems){\n            if(cartItems[item]>0){\n                totalItem += cartItems[item]\n            }\n        }\n        return totalItem;\n    }\n\n    const contextValue ={getTotalCartItems, getTotalCartAmount, all_product, cartItems, addToCart, removeFromCart}\n\n\n    return (\n        <ShopContext.Provider value={contextValue}>\n            {props.children}\n        </ShopContext.Provider>\n    )\n}\n\nexport default ShopContextProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}